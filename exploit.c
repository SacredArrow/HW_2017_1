#include <stdio.h>

// Алгоритм решения:
// 1. Отключается рандомизация
// 2. Через ассемблер просматривается кол-во байт, выделенных для buffer(18)
// 3. Значит, нужно напечатать 18+4(размер saved ebp)=22 любых символа+return
// address
// 4. Компилировать с gcc -o exploit exploit.c -fno-stack-protector -m32

void other() {
  printf("Thank You Mario, But Our Princess is in Another Castle!\n");
}

void input() {
  char buffer[10];
  printf("Address of princess is %p\n", other);
  printf("Enter some text:");
  scanf("%s", buffer);
  printf("You entered: %s\n", buffer);
}

int main() {
  input();

  return 0;
}
